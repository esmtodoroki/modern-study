<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
      #app {
        text-align: center;
        font-weight: bold;
      }
      #counterBox {
        font-size: 20px;
        color: gold;
        text-align: right;
        background-color: black;
        width: 80px;
      }
      #countUpButton {
        font-size: 14px;
        color:black;
        text-align:center;
        width: 120px;
      }
      #resetButton {
        font-size: 14px;
        color:red;
        text-align:center;
        width: 120px;
      }
      #saveButton {
        font-size: 14px;
        color:darkgreen;
        text-align:center;
        width: 120px;
      }
    </style>
  </head>
  <body>
    <div id="app">
      <h1>シンプルカウンター</h1>
      <p>カウンター <input type="text" id="counterBox" v-bind:value="counter"></p>
      <p><button id="countUpButton" v-on:click="countUp">カウントアップ</button>
        <button id="resetButton" v-on:click="resetCounter">リセット</button></p>
      <p><button id="saveButton" v-on:click="saveCounter">カウント保存</button></p>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.11/dist/vue.js"></script>
    <script>
      // Vueのインスタンス生成
      var app = new Vue({
        el: '#app' ,
        data: {
          counter: 0
        },
        created: function() {
          // ページロード時にスプレッドシートからカウンター値を読み込んでセット
          google.script.run.withSuccessHandler(this.loadCounter).getSheetData()
        },
        methods: {
          loadCounter(result) {    // googleスクリプト用コールバック関数
            this.counter = result
          },
          countUp() {              // カウンターを1upする
            this.counter++
          },
          resetCounter() {         // カウンターを0にリセットする
            this.counter = 0
          },
          saveCounter() {          // カウンターをスプレッドシートに保存する
            google.script.run.setSheetData(this.counter)
            alert('保存しました')
          }
        }
      })
    </script>
  </body>
</html>
